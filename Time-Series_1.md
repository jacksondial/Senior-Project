---
title: "COVID-19 Time Series"
output:
  html_document:
    code_folding: hide
    keep_md: true
editor_options: 
  chunk_output_type: console
---




```r
library(tidyverse)
library(readxl)
library(TSstudio)
```


```r
data1 <- read_xlsx("../Public Records Request 11-17-2020.xlsx")
data1$County <- factor(data1$County)

data2 <- data1 %>% 
  mutate(dummy_var = 1) %>% 
  group_by(`Report Date`, County) %>%
  summarise(count_cases = sum(dummy_var)) %>% 
  mutate(population = case_when(
    County == "Bonneville" ~ 119062,
    County == "Clark" ~ 845,
    County == "Custer" ~ 4315,
    County == "Fremont" ~ 13099,
    County == "Jefferson" ~ 29871,
    County == "Lemhi" ~ 8027,
    County == "Madison" ~ 39907,
    County == "Teton" ~ 12142
  )) %>% 
  mutate(case_adj = (count_cases / population) * 10000) 

data_rename <- data1 %>% 
  rename(
    report_date =`Report Date`,
    released_date = `Released from EIPH Monitoring`,
    age_group = `Age Group (by decade)`,
    exposure = `Source of Exposure`
  )

duration_monitored <- data_rename %>% 
  mutate(total_time = difftime(released_date, report_date, unit = "days")) %>% 
  mutate(pos_time = sqrt(as.numeric(total_time)^2))

data_agg <- data2 %>% 
  group_by(`Report Date`) %>% 
  summarise(total_case_adj = sum(case_adj))
```


```r
my_ts <- ts(data_agg$total_case_adj, start = c(2020),frequency = 365)

plot.ts(my_ts)
```

![](Time-Series_1_files/figure-html/unnamed-chunk-3-1.png)<!-- -->



```r
ggplot(data_agg, aes(x = `Report Date`, y = total_case_adj))+
  geom_line()+
  theme_bw()
```

![](Time-Series_1_files/figure-html/unnamed-chunk-4-1.png)<!-- -->

```r
library(TTR)
time_series_smooth <- SMA(my_ts, n = 7)
plot.ts(time_series_smooth, xlab = "Days since March 14, 2020", ylab = "Smoothened Number of Cases in EIPH")
```

![](Time-Series_1_files/figure-html/unnamed-chunk-4-2.png)<!-- -->

```r
ts_info(my_ts)
```

```
##  The my_ts series is a ts object with 1 variable and 208 observations
##  Frequency: 365 
##  Start time: 2020 1 
##  End time: 2020 208
```


```r
data(USVSales)
ts_info(USVSales)
```

```
##  The USVSales series is a ts object with 1 variable and 528 observations
##  Frequency: 12 
##  Start time: 1976 1 
##  End time: 2019 12
```

```r
ts_plot(USVSales,
        Xgrid = TRUE,
        Ygrid = TRUE,
        Xtitle = "Year",
        Ytitle = "Thousands of Units",
        title = "US Monthly Total Vehicles Sales")
```

<!--html_preserve--><div id="htmlwidget-5e8d92dcf17751627951" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5e8d92dcf17751627951">{"x":{"visdat":{"5a58efb76e1":["function () ","plotlyVisDat"]},"cur_data":"5a58efb76e1","attrs":{"5a58efb76e1":{"x":{},"y":{},"mode":"lines","line":{"width":2,"dash":null,"color":"#00526d"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Year","showgrid":true},"yaxis":{"domain":[0,1],"automargin":true,"title":"Thousands of Units","showgrid":true},"title":"US Monthly Total Vehicles Sales","hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[1976,1976.08333333333,1976.16666666667,1976.25,1976.33333333333,1976.41666666667,1976.5,1976.58333333333,1976.66666666667,1976.75,1976.83333333333,1976.91666666667,1977,1977.08333333333,1977.16666666667,1977.25,1977.33333333333,1977.41666666667,1977.5,1977.58333333333,1977.66666666667,1977.75,1977.83333333333,1977.91666666667,1978,1978.08333333333,1978.16666666667,1978.25,1978.33333333333,1978.41666666667,1978.5,1978.58333333333,1978.66666666667,1978.75,1978.83333333333,1978.91666666667,1979,1979.08333333333,1979.16666666667,1979.25,1979.33333333333,1979.41666666667,1979.5,1979.58333333333,1979.66666666667,1979.75,1979.83333333333,1979.91666666667,1980,1980.08333333333,1980.16666666667,1980.25,1980.33333333333,1980.41666666667,1980.5,1980.58333333333,1980.66666666667,1980.75,1980.83333333333,1980.91666666667,1981,1981.08333333333,1981.16666666667,1981.25,1981.33333333333,1981.41666666667,1981.5,1981.58333333333,1981.66666666667,1981.75,1981.83333333333,1981.91666666667,1982,1982.08333333333,1982.16666666667,1982.25,1982.33333333333,1982.41666666667,1982.5,1982.58333333333,1982.66666666667,1982.75,1982.83333333333,1982.91666666667,1983,1983.08333333333,1983.16666666667,1983.25,1983.33333333333,1983.41666666667,1983.5,1983.58333333333,1983.66666666667,1983.75,1983.83333333333,1983.91666666667,1984,1984.08333333333,1984.16666666667,1984.25,1984.33333333333,1984.41666666667,1984.5,1984.58333333333,1984.66666666667,1984.75,1984.83333333333,1984.91666666667,1985,1985.08333333333,1985.16666666667,1985.25,1985.33333333333,1985.41666666667,1985.5,1985.58333333333,1985.66666666667,1985.75,1985.83333333333,1985.91666666667,1986,1986.08333333333,1986.16666666667,1986.25,1986.33333333333,1986.41666666667,1986.5,1986.58333333333,1986.66666666667,1986.75,1986.83333333333,1986.91666666667,1987,1987.08333333333,1987.16666666667,1987.25,1987.33333333333,1987.41666666667,1987.5,1987.58333333333,1987.66666666667,1987.75,1987.83333333333,1987.91666666667,1988,1988.08333333333,1988.16666666667,1988.25,1988.33333333333,1988.41666666667,1988.5,1988.58333333333,1988.66666666667,1988.75,1988.83333333333,1988.91666666667,1989,1989.08333333333,1989.16666666667,1989.25,1989.33333333333,1989.41666666667,1989.5,1989.58333333333,1989.66666666667,1989.75,1989.83333333333,1989.91666666667,1990,1990.08333333333,1990.16666666667,1990.25,1990.33333333333,1990.41666666667,1990.5,1990.58333333333,1990.66666666667,1990.75,1990.83333333333,1990.91666666667,1991,1991.08333333333,1991.16666666667,1991.25,1991.33333333333,1991.41666666667,1991.5,1991.58333333333,1991.66666666667,1991.75,1991.83333333333,1991.91666666667,1992,1992.08333333333,1992.16666666667,1992.25,1992.33333333333,1992.41666666667,1992.5,1992.58333333333,1992.66666666667,1992.75,1992.83333333333,1992.91666666667,1993,1993.08333333333,1993.16666666667,1993.25,1993.33333333333,1993.41666666667,1993.5,1993.58333333333,1993.66666666667,1993.75,1993.83333333333,1993.91666666667,1994,1994.08333333333,1994.16666666667,1994.25,1994.33333333333,1994.41666666667,1994.5,1994.58333333333,1994.66666666667,1994.75,1994.83333333333,1994.91666666667,1995,1995.08333333333,1995.16666666667,1995.25,1995.33333333333,1995.41666666667,1995.5,1995.58333333333,1995.66666666667,1995.75,1995.83333333333,1995.91666666667,1996,1996.08333333333,1996.16666666667,1996.25,1996.33333333333,1996.41666666667,1996.5,1996.58333333333,1996.66666666667,1996.75,1996.83333333333,1996.91666666667,1997,1997.08333333333,1997.16666666667,1997.25,1997.33333333333,1997.41666666667,1997.5,1997.58333333333,1997.66666666667,1997.75,1997.83333333333,1997.91666666667,1998,1998.08333333333,1998.16666666667,1998.25,1998.33333333333,1998.41666666667,1998.5,1998.58333333333,1998.66666666667,1998.75,1998.83333333333,1998.91666666667,1999,1999.08333333333,1999.16666666667,1999.25,1999.33333333333,1999.41666666667,1999.5,1999.58333333333,1999.66666666667,1999.75,1999.83333333333,1999.91666666667,2000,2000.08333333333,2000.16666666667,2000.25,2000.33333333333,2000.41666666667,2000.5,2000.58333333333,2000.66666666667,2000.75,2000.83333333333,2000.91666666667,2001,2001.08333333333,2001.16666666667,2001.25,2001.33333333333,2001.41666666667,2001.5,2001.58333333333,2001.66666666667,2001.75,2001.83333333333,2001.91666666667,2002,2002.08333333333,2002.16666666667,2002.25,2002.33333333333,2002.41666666667,2002.5,2002.58333333333,2002.66666666667,2002.75,2002.83333333333,2002.91666666667,2003,2003.08333333333,2003.16666666667,2003.25,2003.33333333333,2003.41666666667,2003.5,2003.58333333333,2003.66666666667,2003.75,2003.83333333333,2003.91666666667,2004,2004.08333333333,2004.16666666667,2004.25,2004.33333333333,2004.41666666667,2004.5,2004.58333333333,2004.66666666667,2004.75,2004.83333333333,2004.91666666667,2005,2005.08333333333,2005.16666666667,2005.25,2005.33333333333,2005.41666666667,2005.5,2005.58333333333,2005.66666666667,2005.75,2005.83333333333,2005.91666666667,2006,2006.08333333333,2006.16666666667,2006.25,2006.33333333333,2006.41666666667,2006.5,2006.58333333333,2006.66666666667,2006.75,2006.83333333333,2006.91666666667,2007,2007.08333333333,2007.16666666667,2007.25,2007.33333333333,2007.41666666667,2007.5,2007.58333333333,2007.66666666667,2007.75,2007.83333333333,2007.91666666667,2008,2008.08333333333,2008.16666666667,2008.25,2008.33333333333,2008.41666666667,2008.5,2008.58333333333,2008.66666666667,2008.75,2008.83333333333,2008.91666666667,2009,2009.08333333333,2009.16666666667,2009.25,2009.33333333333,2009.41666666667,2009.5,2009.58333333333,2009.66666666667,2009.75,2009.83333333333,2009.91666666667,2010,2010.08333333333,2010.16666666667,2010.25,2010.33333333333,2010.41666666667,2010.5,2010.58333333333,2010.66666666667,2010.75,2010.83333333333,2010.91666666667,2011,2011.08333333333,2011.16666666667,2011.25,2011.33333333333,2011.41666666667,2011.5,2011.58333333333,2011.66666666667,2011.75,2011.83333333333,2011.91666666667,2012,2012.08333333333,2012.16666666667,2012.25,2012.33333333333,2012.41666666667,2012.5,2012.58333333333,2012.66666666667,2012.75,2012.83333333333,2012.91666666667,2013,2013.08333333333,2013.16666666667,2013.25,2013.33333333333,2013.41666666667,2013.5,2013.58333333333,2013.66666666667,2013.75,2013.83333333333,2013.91666666667,2014,2014.08333333333,2014.16666666667,2014.25,2014.33333333333,2014.41666666667,2014.5,2014.58333333333,2014.66666666667,2014.75,2014.83333333333,2014.91666666667,2015,2015.08333333333,2015.16666666667,2015.25,2015.33333333333,2015.41666666667,2015.5,2015.58333333333,2015.66666666667,2015.75,2015.83333333333,2015.91666666667,2016,2016.08333333333,2016.16666666667,2016.25,2016.33333333333,2016.41666666667,2016.5,2016.58333333333,2016.66666666667,2016.75,2016.83333333333,2016.91666666667,2017,2017.08333333333,2017.16666666667,2017.25,2017.33333333333,2017.41666666667,2017.5,2017.58333333333,2017.66666666667,2017.75,2017.83333333333,2017.91666666667,2018,2018.08333333333,2018.16666666667,2018.25,2018.33333333333,2018.41666666667,2018.5,2018.58333333333,2018.66666666667,2018.75,2018.83333333333,2018.91666666667,2019,2019.08333333333,2019.16666666667,2019.25,2019.33333333333,2019.41666666667,2019.5,2019.58333333333,2019.66666666667,2019.75,2019.83333333333,2019.91666666667],"y":[885.2,994.7,1243.6,1191.2,1203.2,1254.7,1162.3,1026.1,1057.9,1129.4,1084.4,1061.8,969.9,1092.1,1451.1,1354.4,1377.1,1459.8,1202,1234.5,1104.6,1341.3,1181.6,1090.6,931.3,1071.4,1480.6,1406.5,1557.6,1549.4,1289.2,1317.1,1103.5,1397,1248.7,1068.5,1077.5,1148.7,1483.8,1304.6,1373,1183.8,1164.4,1207.2,1029.6,1197.6,1018.6,959.7,1042,1038.7,1141.9,946.6,893.8,932.7,1006.6,884.2,847.4,1043.4,870.5,821.4,814.3,949.2,1178.8,962.9,933.1,942.7,896.9,1009,864.8,822,743,673.2,714.4,840.5,1057.3,877.2,1020.2,868.4,827.4,794,891.1,840.9,971.5,839.3,789.3,821.6,1102,1012.3,1109.9,1205.4,1051.7,993.1,980.4,1126,1050.2,1054,1056.9,1158.9,1351.5,1245.8,1451.7,1315.9,1237.2,1129.6,1053.4,1266.5,1141.1,1074.8,1196.6,1210.6,1391,1380.3,1498.9,1332.9,1337.6,1345.8,1463.5,1243.2,1120.9,1198.8,1213.8,1182.2,1297.6,1390.1,1530.3,1426.5,1378,1344.1,1733.6,1270.6,1119.9,1431.1,918.9,1148.4,1381.7,1385.3,1298.5,1419.6,1355.8,1400.6,1300.5,1193.2,1110.7,1249.2,1122.5,1308.8,1505,1333.5,1455.4,1483.1,1302.8,1317,1223.2,1249.9,1191.1,1285.2,1084.2,1127.3,1337.6,1354.8,1438.4,1329.2,1279.1,1441.9,1263.8,1116.9,1047.6,1011.9,1161.3,1073.4,1295.2,1226.3,1332.1,1306.1,1244.4,1196.9,1144.8,1169,1000.5,987.2,839.3,927.5,1103.1,1059.6,1174,1175.3,1185.2,1063,1062.2,1047.6,932.1,961.5,867.8,988.5,1128.4,1144.9,1169.7,1297,1158.2,1065.2,1095.4,1132.2,988.6,1070.7,915.3,976.1,1228.9,1273.5,1342.2,1383.1,1266.9,1158.8,1164.6,1182.5,1140.9,1152.7,1045.5,1170.9,1472.2,1337.9,1382.1,1479.6,1219.5,1329.3,1252.1,1291.8,1197.9,1218.9,1031.5,1128.7,1403.3,1216,1427.5,1477.2,1255.3,1365.2,1214.4,1226,1169.1,1202.6,1050.6,1237.9,1404.4,1359.3,1522.9,1404.2,1317.3,1333.4,1231.4,1296.6,1146.4,1151.8,1114.6,1177.4,1425.9,1310.3,1435.8,1355,1376.6,1348.2,1238.5,1282,1146.1,1287.7,1044.1,1173,1405.5,1390.9,1543.9,1606.6,1264.9,1265.1,1314.4,1407.5,1176.4,1375,1123.7,1325.7,1580.2,1451.7,1632.6,1651.4,1529,1523.6,1442.5,1396.8,1317.2,1440.6,1239.3,1539.3,1713,1538.9,1664.9,1662.7,1468.6,1578.8,1506.3,1367.7,1260.9,1271.2,1196.3,1381.5,1627.8,1377,1635.2,1652.2,1374.6,1478.2,1312.5,1753.2,1347.9,1336.1,1129.999,1328.755,1541.215,1471.801,1538.496,1563.938,1551.996,1734.956,1250.986,1331.09,1227.557,1467.708,1108.279,1237.619,1474.819,1436.733,1601.145,1502.328,1538.781,1656.167,1329.499,1333.497,1285.36,1463.264,1149.668,1303.718,1540.321,1455.643,1660.854,1480.758,1589.173,1463.409,1470.081,1370.093,1231.197,1583.603,1095.851,1286.074,1615.983,1542.051,1537.321,1720.006,1845.713,1524.158,1366.93,1184.16,1200.786,1525.713,1176.162,1298.13,1576.647,1489.804,1533.712,1545.268,1531.114,1530.014,1394.215,1260.626,1236.584,1476.413,1124.216,1285.136,1574.877,1365.965,1590.262,1481.21,1331.024,1500.386,1335.814,1256.533,1200.511,1414.147,1063.408,1196.431,1378.605,1272.999,1420.485,1212.54,1156.003,1269.113,984.592,859.026,763.936,916.12,670.466,701.635,872.848,832.588,938.41,874.874,1011.769,1274.678,759.633,853.942,761.865,1049.27,712.469,793.362,1083.953,997.334,1117.57,1000.455,1065.748,1011.564,973.954,965.135,888.085,1162.897,836.366,1007.082,1276.843,1173.52,1081.272,1071.229,1086.064,1094.479,1076.037,1048.258,1028.774,1268.462,938.17,1175.82,1434.004,1204.471,1369.493,1310.158,1171.809,1305.342,1206.182,1119.148,1169.803,1375.084,1065.798,1217.858,1479.427,1313.768,1473.275,1425.802,1335.833,1527.483,1152.814,1235.532,1271.446,1383.676,1043.019,1221.37,1562.748,1408.232,1644.367,1451.814,1473.962,1607.315,1272.036,1312.329,1324.117,1538.534,1177.91,1285.147,1579.627,1479.335,1668.452,1518.66,1546.818,1598.265,1474.925,1486.42,1358.777,1671.288,1188.775,1374.272,1614.069,1524.1,1552.659,1548.86,1546.818,1539.79,1462.065,1397.057,1399.375,1717.933,1164.323,1352.076,1582.674,1449.717,1543.862,1502.804,1441.011,1512.07,1553.133,1385.649,1424.527,1639.555,1181.715,1328.14,1687.609,1391.226,1626.484,1586.664,1403.118,1527.416,1474.997,1405.908,1422.219,1665.906,1171.503,1288.278,1642.75,1372.659,1628.074,1554.748,1443.947,1685.342,1315.632,1380.18,1446.483,1565.023],"mode":"lines","line":{"color":"#00526d","width":2,"dash":[]},"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->

